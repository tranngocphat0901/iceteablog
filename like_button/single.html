<div id="like-section">
    <button id="like-button" onclick="likePost('{{ .File.BaseFileName }}')">ğŸ‘ Like</button>
    <span id="like-count">0</span> Likes
</div>

<script>
const apiUrl = "https://255125pygl.execute-api.ap-southeast-1.amazonaws.com/production/like";

function likePost(postID) {
    console.log("Gá»­i request Like cho bÃ i viáº¿t:", postID);

    fetch(`${apiUrl}?post_id=${postID}`)
    .then(response => response.json()) // Chuyá»ƒn response vá» JSON object
    .then(data => {
        console.log("Dá»¯ liá»‡u tá»« API:", data);
        if (typeof data === "string") {
            data = JSON.parse(data); // Náº¿u data lÃ  string JSON, parse láº¡i thÃ nh object
        }
        if (data.likes !== undefined) {
            document.getElementById("like-count").innerText = data.likes;
        } else {ÃŸÃŸÃŸ
            console.error("Dá»¯ liá»‡u tráº£ vá» khÃ´ng cÃ³ trÆ°á»ng 'likes'", data);
        }
    })
    .catch(error => console.error("Lá»—i khi gá»i API:", error));
}

// Load sá»‘ like khi trang táº£i
window.onload = function () {
    const postID = "{{ .File.BaseFileName }}";
    console.log("Táº£i sá»‘ like cho bÃ i viáº¿t:", postID);

    fetch(`${apiUrl}?post_id=${postID}`)
    .then(response => response.json()) // Chuyá»ƒn response vá» JSON object
    .then(data => {
        console.log("Dá»¯ liá»‡u API khi táº£i trang:", data);
        if (typeof data === "string") {
            data = JSON.parse(data); // Náº¿u data lÃ  string JSON, parse láº¡i thÃ nh object
        }
        if (data.likes !== undefined) {
            document.getElementById("like-count").innerText = data.likes;
        } else {
            console.error("Dá»¯ liá»‡u tráº£ vá» khÃ´ng cÃ³ trÆ°á»ng 'likes'", data);
        }
    })
    .catch(error => console.error("Lá»—i khi táº£i sá»‘ likes:", error));
};
</script>
